{"data":{"ghostPost":{"id":"Ghost__Post__5c12d7bfe875ad7bb86736ed","title":"Dynamic Tension! Creating and Using Dynamic Named Ranges in Excel","slug":"dynamic-named-ranges-in-excel","featured":false,"feature_image":"https://hackersandslackers.com/content/images/2018/08/maxidk@2x.jpg","excerpt":"Dynamically load data in smart pivot tables.","custom_excerpt":"Dynamically load data in smart pivot tables.","created_at_pretty":"30 August, 2018","published_at_pretty":"01 September, 2018","updated_at_pretty":"02 February, 2019","created_at":"2018-08-30T17:00:23.000-04:00","published_at":"2018-08-31T21:13:00.000-04:00","updated_at":"2019-02-02T03:50:02.000-05:00","meta_title":"Dynamic Named Ranges in Excel | Hackers And Slackers","meta_description":"Use a named dynamic range and a form control to dynamically auto-populate and refresh Excel pivot tables.","og_description":"Use a named dynamic range and a form control to dynamically auto-populate and refresh Excel pivot tables.","og_image":"https://hackersandslackers.com/content/images/2018/08/maxidk@2x.jpg","og_title":"Dynamic Tension! Creating and Using Dynamic Named Ranges in Excel","twitter_description":"Use a named dynamic range and a form control to dynamically auto-populate and refresh Excel pivot tables.","twitter_image":"https://hackersandslackers.com/content/images/2018/08/maxidk@2x.jpg","twitter_title":"Dynamic Tension! Creating and Using Dynamic Named Ranges in Excel","authors":[{"name":"Max Mileaf","slug":"snacks","bio":"One of three therapists in the known universe who knows how to use a computer. Finds meaning in highly protected data, in a cave, utilizing nothing but a box of scraps. ","profile_image":"https://hackersandslackers.com/content/images/2019/03/max2.jpg","twitter":null,"facebook":null,"website":null}],"primary_author":{"name":"Max Mileaf","slug":"snacks","bio":"One of three therapists in the known universe who knows how to use a computer. Finds meaning in highly protected data, in a cave, utilizing nothing but a box of scraps. ","profile_image":"https://hackersandslackers.com/content/images/2019/03/max2.jpg","twitter":null,"facebook":null,"website":null},"primary_tag":{"name":"Excel","slug":"excel","description":"Pro Excel secrets and magic. The kind of industry knowledge to put junior finance guys out of business.","feature_image":"https://res.cloudinary.com/hackers-and-slackers/image/upload/q_auto:good/v1/images/excelseries-1.jpg","meta_description":"Pro Excel secrets and magic. The kind of industry knowledge to put junior finance guys out of business.","meta_title":"Adventures in Excel","visibility":"public"},"tags":[{"name":"Excel","slug":"excel","description":"Pro Excel secrets and magic. The kind of industry knowledge to put junior finance guys out of business.","feature_image":"https://res.cloudinary.com/hackers-and-slackers/image/upload/q_auto:good/v1/images/excelseries-1.jpg","meta_description":"Pro Excel secrets and magic. The kind of industry knowledge to put junior finance guys out of business.","meta_title":"Adventures in Excel","visibility":"public"},{"name":"Data Analysis","slug":"data-analysis","description":"Drawing meaningful conclusions from data. Includes interpretation, dashboard creation, and data manipulation.","feature_image":null,"meta_description":"Drawing meaningful conclusions from data. Includes interpretation, dashboard creation, and data manipulation.","meta_title":"Data Analysis | Hackers and Slackers","visibility":"public"},{"name":"#Adventures in Excel","slug":"adventures-in-excel","description":"Excel secrets and magic. The kind of industry knowledge that could put financial analysts out of business.","feature_image":"https://res.cloudinary.com/hackers-and-slackers/image/upload/q_auto:good/v1/images/excelseries-1.jpg","meta_description":"Pro Excel secrets and magic. The kind of industry knowledge to put junior finance guys out of business.","meta_title":"Adventures in Excel","visibility":"internal"}],"plaintext":"First things first, 10 points to anyone who understands what the title is\nreferring to (that's either Charles Atlas' workout philosophy, or one of core\ntenants of Bokononism in Kurt Vonnegut's standout Cat's Cradle). \n\nNow, with my obscure reference quota filled for the day, let's assume that\nyou've been working as an analyst for some time now. As stated in a previous\npost, generally you're likely to get promoted into a management position, where\nyou no longer need your formidable skills of analysis, and they too, like all\ngood things, will atrophy to nothingness. However, for those of you who have\ndemonstrated such overwhelming nuance of technique that your company fears the\nloss of your truly awe-inspiring abilities more than they love adhering to the\nPeter Principle, there may indeed be another road.\n\nThis unlikely confluence of events generally begins after the fifth or sixth\ntime that you've been asked to write a step-by-step tutorial showing how you\nbuilt a specific report, only to find out that if written out in a truly \nstep-wise fashion would take up 16 pages, and thus would never EVER be looked\nat. This phenomenon serves a dual purpose: \n\n 1. It misleads your company into believing that what you do is complex.\n 2. It is taken as evidence that you are a literal wizard, and you can't train a\n    muggle to do magic. \n\nOnce your company has taken the bait, they may realize that you are a true elite\noperator, and that the loss of your abilities would result in a substantial\ndrain on your business' intelligence. Enter the Lead Analyst (also called a head\nanalyst, chief analyst, or executive analyst if where you work is incredibly far\nup it's own ass). This job title exists solely to reward those of you who have\nbuilt up enough number crunching credit to make your employer realize that if\nthey promote you to a manager, they lose, and if they don't promote you at all,\nyou can leave at any time. \n\nSo, hotshot, what does this job involve? Simply put, your company no longer\nquestions you about...basically anything (and if they ever do, say you're\ncompiling, always works) and you might even be entrusted to speak directly to\nthe notorious Dataratti that we spoke of several posts ago (they're all actually\nreally cool guys, and appreciate being able to talk to someone who understands\nwhat their job and capabilities actually are). In exchange for these two awesome\nperks, all you have to be able to do is build reports that can be used by anyone\n...\n\nNow all of you who work in the field and have to engage in this practice just\nlet out an enormous sigh, and the reason for this is because now you have to\nwrite reports that:\n\n1. Can't use macros because the end user doesn't know what a macro is.\n2. Need to have built in constraints because \"it just needs to be there to work\"\nis literally begging someone to mess up a perfectly good formula.\n3. Can't rely on the manual typing of actual formulae because explaining to\nsomeone that the \"dollar sign isn't a typo\" to someone never quite sticks.\n4. Can't utilize your own macros because the end user isn't going to have access\nto them, and finally... \n5. You can no longer say things like \"pivot out\", \"lookup\", or \"index\" and\ninstead need to break each of those things down into a series of button clicks\n(hence why the documentation becomes 16 pages).\n\nWith that being said, let's jump into one of the easiest ways that you can build\nreports that allow even the unenlightened the ability to touch the sun: using a\nnamed dynamic range and a form control to auto-populate and refresh a pivot\ntable.\n\nNow, if any of those words are unfamiliar to you, you need to go back to the\nbeginning of the series (with special attention to the post regarding naming\nranges and active-X controls) so that you know how to do the following:\n\n 1. Build a pivot table\n 2. Name a range\n\nIf you've got the tricks in the bag, let's get going. In order to get this trick\nto work the first step is building a named dynamic range. This is a glorious\ntrick that takes the convenience of naming a range (being able to grab that\ninformation from anywhere in a workbook) along with the UNLIMITED POWER of\nassociating anything that someone may plug into the range with the name. \n\nFirst, let's start with a sample data-set of super heroes and their secret\nidentities, like so (you'll need developer active for this to work): \n\nMiles Morales and Amadeus Cho notwithstandingSo, now's where the magic happens:\nclick formulas-->Name Manager\n\nNote the dialogue box.In the resulting dialog box, click \"new\":\n\nSeen here: how these become 16 page tutorialsIn the resulting dialog box, name\nthe range whatever you want (just remember...no spaces), but the magic really\nhappens at the bottom where it says \"refers to\", as shown here: \n\nPictured here: what the coolest thing looks like before it happensNow, in that\nbox, you'll notice that you can put in a formula, and this one is KEY to\nremember both for this, and anytime you want to make a dynamic range in the\nfuture, and it is: \n=OFFSET(Sheet1!$A$1,0,0,COUNTA(Sheet1!$A:$A),COUNTA(Sheet1!$1:$1))\n* substitute the name of your worksheet for sheet1. \nEssentially, OFFSET  is how you set your imaginary cursor (remember, you CAN\ntechnically do everything you see in Excel from a command line, and this is how\nit knows where you are). It requires 3-5 variables: \n\n * The first (the reference) is what you want your \"mouse\" to select before it\n   finds it's way elsewhere.\n * The second and third is the number of rows and columns you want to move in\n   order to select your next item. You can end here, but you'd just wind up\n   moving your \"cursor\" to another cell. Instead, we set this to zero for both\n   because you don't want to move anywhere. \n * The 4th is the hight (in cells) of what you're selecting (that way, you can\n   select any number of cells vertically from where your cursor wound up) and we\n   use \"COUNTA\" here to mean the number of cells that aren't blank in column A.\n * The 5th and final variable is the width which serves the same function as\n   height in the other direction. By using \"COUNTA\" here, we're selecting the\n   number of columns that aren't blank in row 1.\n\nIf you did everything right, you should end up like this: \n\nNow you can officially claim to be \"Dynamic\" on your resumeIf you're thinking\nwith portals, you may have already pieced together what we've done here: by\nnaming the range, we can substitute any variable that'll support an array with\nthe name of the range, AND by using that offset formula, we've just made it so\nthat no matter what you throw into this first sheet, it gets added to the range.\n \n\nThis by itself is very cool, and very useful, but let's take it a step further\nand I'll show you how you can use this dynamic named range to make an \"idiot\nproof\" updater for a pivot table. \n\nThe first step is to of course make a pivot table, however, we're going to do\nsomething daring: a pivot table requires an array...and we've just created an\narray that's DYNAMIC. So, click insert, pivot table, and then when it asks you\nwhat you what you want in the table, tell it that you want to put powers in\nthere (that's the name of my range) like so:\n\nNo one man should have all this power...and boom:\n\nNot for VillainsBUT IT DOESN'T END THERE FOLKS. As your range is dynamic, you\ncan add whatever rows or columns to the first page as you wish, and then if you\nrefresh your pivot table (right click, refresh) these changes will be\nreflected...watch\n\nSpecifically for VillainsIT'S DYNAMIC!So, now you've learned how to:\n\n * Create a named dynamic range\n * Use the offset function to set a virtual cursor (this becomes exceedingly\n   important if ever you decide you want to code for real).\n * Refresh a pivot table with information updated in the dynamic range. \n\nNext time, we'll take it up a notch, and remove any sort of thought needed to\nupdate these tables! \n\nIt's Munchin' Time, \n\n-Snacks","html":"<p>First things first, 10 points to anyone who understands what the title is referring to (that's either Charles Atlas' workout philosophy, or one of core tenants of Bokononism in Kurt Vonnegut's standout <em>Cat's Cradle). </em></p><p>Now, with my obscure reference quota filled for the day, let's assume that you've been working as an analyst for some time now. As stated in a previous post, generally you're likely to get promoted into a management position, where you no longer need your formidable skills of analysis, and they too, like all good things, will atrophy to nothingness. However, for those of you who have demonstrated such overwhelming nuance of technique that your company fears the loss of your truly awe-inspiring abilities more than they love adhering to the Peter Principle, there may indeed be another road.</p><p>This unlikely confluence of events generally begins after the fifth or sixth time that you've been asked to write a step-by-step tutorial showing how you built a specific report, only to find out that if written out in a <em>truly </em>step-wise fashion would take up 16 pages, and thus would never EVER be looked at. This phenomenon serves a dual purpose: </p><ol><li>It misleads your company into believing that what you do is <em>complex.</em></li><li>It is taken as evidence that you are a literal wizard, and you can't train a muggle to do magic. <em> </em></li></ol><p>Once your company has taken the bait, they may realize that you are a true elite operator, and that the loss of your abilities would result in a substantial drain on your business' intelligence. Enter the Lead Analyst (also called a head analyst, chief analyst, or executive analyst if where you work is incredibly far up it's own ass). This job title exists solely to reward those of you who have built up enough number crunching credit to make your employer realize that if they promote you to a manager, they lose, and if they don't promote you at all, you can leave at any time. </p><p>So, hotshot, what does this job involve? Simply put, your company no longer questions you about...basically anything (and if they ever do, say you're compiling, always works) and you might even be entrusted to speak directly to the notorious Dataratti that we spoke of several posts ago (they're all actually really cool guys, and appreciate being able to talk to someone who understands what their job and capabilities actually are). In exchange for these two awesome perks, all you have to be able to do is build reports that can be used by <em>anyone</em>...</p><p>Now all of you who work in the field and have to engage in this practice just let out an enormous sigh, and the reason for this is because now you have to write reports that:<br><br>1. Can't use macros because the end user doesn't know what a macro is.<br>2. Need to have built in constraints because \"it just needs to be there to work\" is literally begging someone to mess up a perfectly good formula.<br>3. Can't rely on the manual typing of actual formulae because explaining to someone that the \"dollar sign isn't a typo\" to someone never quite sticks.<br>4. Can't utilize your own macros because the end user isn't going to have access to them, and finally... <br>5. You can no longer say things like \"pivot out\", \"lookup\", or \"index\" and instead need to break each of those things down into a series of button clicks (hence why the documentation becomes 16 pages).</p><p>With that being said, let's jump into one of the easiest ways that you can build reports that allow even the unenlightened the ability to touch the sun: using a named dynamic range and a form control to auto-populate and refresh a pivot table.</p><p>Now, if any of those words are unfamiliar to you, you need to go back to the beginning of the series (with special attention to the post regarding naming ranges and active-X controls) so that you know how to do the following:</p><ol><li>Build a pivot table</li><li>Name a range</li></ol><p>If you've got the tricks in the bag, let's get going. In order to get this trick to work the first step is building a <strong>named dynamic range. </strong>This is a glorious trick that takes the convenience of naming a range (being able to grab that information from anywhere in a workbook) along with the <em>UNLIMITED POWER </em>of associating anything that someone may plug into the range with the name. </p><p>First, let's start with a sample data-set of super heroes and their secret identities, like so (you'll need developer active for this to work): </p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-2.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-7.png\" class=\"kg-image\"><figcaption>Miles Morales and Amadeus Cho notwithstanding</figcaption></figure><p>So, now's where the magic happens: click formulas--&gt;Name Manager</p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-1.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-8.png\" class=\"kg-image\"><figcaption>Note the dialogue box.</figcaption></figure><p>In the resulting dialog box, click \"new\":</p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-4.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-9.png\" class=\"kg-image\"><figcaption>Seen here: how these become 16 page tutorials</figcaption></figure><p>In the resulting dialog box, name the range whatever you want (just remember...no spaces), but the magic really happens at the bottom where it says \"refers to\", as shown here: </p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-4.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-10.png\" class=\"kg-image\"><figcaption>Pictured here: what the coolest thing looks like before it happens</figcaption></figure><p>Now, in that box, you'll notice that you can put in a formula, and this one is KEY to remember both for this, and anytime you want to make a dynamic range in the future, and it is: <code>=OFFSET(Sheet1!$A$1,0,0,COUNTA(Sheet1!$A:$A),COUNTA(Sheet1!$1:$1))</code><br>* substitute the name of your worksheet for sheet1. <br>Essentially, <strong>OFFSET</strong> is how you set your imaginary cursor (remember, you CAN technically do everything you <em>see </em>in Excel from a command line, and this is how it knows where you are). It requires 3-5 variables: </p><ul><li>The first (the reference) is what you want your \"mouse\" to select before it finds it's way elsewhere.</li><li>The second and third is the number of rows and columns you want to move in order to select your next item. You can end here, but you'd just wind up moving your \"cursor\" to another cell. Instead, we set this to zero for both because you don't want to <em>move </em>anywhere. </li><li>The 4th is the hight (in cells) of what you're selecting (that way, you can select any number of cells vertically from where your cursor wound up) and we use \"COUNTA\" here to mean the number of cells that aren't blank in column A.</li><li>The 5th and final variable is the width which serves the same function as height in the other direction. By using \"COUNTA\" here, we're selecting the number of columns that aren't blank in row 1.</li></ul><p>If you did everything right, you should end up like this: </p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-1.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-11.png\" class=\"kg-image\"><figcaption>Now you can officially claim to be \"Dynamic\" on your resume</figcaption></figure><p>If you're thinking with portals, you may have already pieced together what we've done here: by naming the range, we can substitute any variable that'll support an array with the name of the range, AND by using that offset formula, we've just made it so that no matter what you throw into this first sheet, it gets added to the range. </p><p>This by itself is very cool, and very useful, but let's take it a step further and I'll show you how you can use this dynamic named range to make an \"idiot proof\" updater for a pivot table. </p><p>The first step is to of course make a pivot table, however, we're going to do something daring: a pivot table requires an array...and we've just created an array that's DYNAMIC. So, click insert, pivot table, and then when it asks you what you what you want in the table, tell it that you want to put powers in there (that's the name of my range) like so:</p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-3.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-12.png\" class=\"kg-image\"><figcaption>No one man should have all this power...</figcaption></figure><p>and boom:</p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-3.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-13.png\" class=\"kg-image\"><figcaption>Not for Villains</figcaption></figure><p>BUT IT DOESN'T END THERE FOLKS. As your range is dynamic, you can add whatever rows or columns to the first page as you wish, and then if you refresh your pivot table (right click, refresh) these changes will be reflected...watch</p><figure class=\"kg-card kg-image-card\"><img src=\"https://res-3.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-14.png\" class=\"kg-image\"><figcaption>Specifically for Villains</figcaption></figure><figure class=\"kg-card kg-image-card\"><img src=\"https://res-4.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-15.png\" class=\"kg-image\"></figure><figure class=\"kg-card kg-image-card\"><img src=\"https://res-5.cloudinary.com/hackers-and-slackers/image/upload/f_auto,q_auto/v1/images/image-16.png\" class=\"kg-image\"><figcaption>IT'S DYNAMIC!</figcaption></figure><p>So, now you've learned how to:</p><ul><li>Create a named dynamic range</li><li>Use the offset function to set a virtual cursor (this becomes exceedingly important if ever you decide you want to code for real).</li><li>Refresh a pivot table with information updated in the dynamic range. </li></ul><p>Next time, we'll take it up a notch, and remove any sort of thought needed to update these tables! </p><p>It's Munchin' Time, </p><p>-Snacks</p>","url":"https://hackersandslackers.com/dynamic-named-ranges-in-excel/","uuid":"b7ef3b91-ecfd-42ab-8288-d2de7d4ceb32","page":false,"codeinjection_foot":"","codeinjection_head":"","comment_id":"5b885ae7075b34075786e311"}},"pageContext":{"slug":"dynamic-named-ranges-in-excel"}}