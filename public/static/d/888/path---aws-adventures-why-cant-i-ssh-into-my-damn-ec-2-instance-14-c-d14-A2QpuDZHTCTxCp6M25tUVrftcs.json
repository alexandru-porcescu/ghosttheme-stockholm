{"data":{"ghostPost":{"id":"Ghost__Post__5c12d7bfe875ad7bb867366f","title":"AWS Adventures: Why Can't I SSH Into My Damn EC2 Instance?","slug":"aws-adventures-why-cant-i-ssh-into-my-damn-ec2-instance","featured":false,"feature_image":"https://hackersandslackers.com/content/images/2018/06/ec2@2x.jpg","excerpt":"Watch as I struggle with the cloud!  My pain, your gain!","custom_excerpt":"Watch as I struggle with the cloud!  My pain, your gain!","created_at_pretty":"06 June, 2018","published_at_pretty":"06 June, 2018","updated_at_pretty":"25 July, 2018","created_at":"2018-06-06T19:27:37.000-04:00","published_at":"2018-06-06T19:41:47.000-04:00","updated_at":"2018-07-24T22:06:03.000-04:00","meta_title":"AWS Adventures: Why Can't I SSH Into My Damn EC2 Instance? | Hackers and Slackers","meta_description":"Watch as I struggle with the cloud!  My pain, your gain!","og_description":"Watch as I struggle with the cloud!  My pain, your gain!","og_image":"https://hackersandslackers.com/content/images/2018/06/ec2@2x.jpg","og_title":"AWS Adventures: Why Can't I SSH Into My Damn EC2 Instance?","twitter_description":"Watch as I struggle with the cloud!  My pain, your gain!","twitter_image":"https://hackersandslackers.com/content/images/2018/06/ec2@2x.jpg","twitter_title":"AWS Adventures: Why Can't I SSH Into My Damn EC2 Instance?","authors":[{"name":"Matthew Alhonte","slug":"matt","bio":"Super villain in somebody's action hero movie. Experienced a radioactive freak accident at a young age, which rendered him part-snake and strangely adept at Python.\n\n","profile_image":"https://hackersandslackers.com/content/images/2019/03/matt.jpg","twitter":"@MattAlhonte","facebook":null,"website":null}],"primary_author":{"name":"Matthew Alhonte","slug":"matt","bio":"Super villain in somebody's action hero movie. Experienced a radioactive freak accident at a young age, which rendered him part-snake and strangely adept at Python.\n\n","profile_image":"https://hackersandslackers.com/content/images/2019/03/matt.jpg","twitter":"@MattAlhonte","facebook":null,"website":null},"primary_tag":{"name":"AWS","slug":"aws","description":"Monolithic cloud architecture via microservices. Become familiar with AWS products, account administration, security practices, and tips to make it all easier.","feature_image":null,"meta_description":"Become familiar with AWS services, account administration, security practices, and tips to make it all easier.","meta_title":"Learn AWS | Hackers and Slackers","visibility":"public"},"tags":[{"name":"AWS","slug":"aws","description":"Monolithic cloud architecture via microservices. Become familiar with AWS products, account administration, security practices, and tips to make it all easier.","feature_image":null,"meta_description":"Become familiar with AWS services, account administration, security practices, and tips to make it all easier.","meta_title":"Learn AWS | Hackers and Slackers","visibility":"public"},{"name":"DevOps","slug":"devops","description":"Configuring server-side infrastructure, cloud architecture, and sometimes networking. Even automate your DevOps workflow with products from Hashicorp.","feature_image":null,"meta_description":"Configuring server-side infrastructure, cloud architecture, and sometimes networking. Even automate your DevOps workflow with products from Hashicorp.","meta_title":"DevOps: Networking And Server Configuration | Hackers and Slackers","visibility":"public"}],"plaintext":"Sometimes I find myself responsible for setting up and maintaining my own\ninfrastructure for doing data stuff. In light of this, I've taken it upon myself\nto learn more about AWS in order for this experience to be less terrifying. I've\nbeen following a course on Udemy for the AWS Solutions Architect Certification.\nSo far, so good.\n\nCut to the EC2 section. Has you spin up a little EC2 instance and SSH into it. I\nwould find myself SSHing in, then after a few minutes my connection would be\nreset and then any further attempts would be met with a Resource temporarily\nunavailable.\n\nI googled around. Lots of stuff that didn't work. I logged into a client's\nconsole that I had access to, tried to see if there were any settings that were\ndifferent from mine. What on Earth did I mess with? I first made an AWS account\nin 2012, and go into phases of messing with my personal account and forgetting\nit exists. I must have hit some kind of \"Make it so every server you launch is\nunreachable and useless\" button at some point, then forgotten where this button\nwas.\n\nIt's a tough little jungle. There's numerous different versions of security on\nAWS. Then, finally, I noticed an angel on StackOverflow posted that you should\ncheck to see whether you have a public DNS address. Turns out I didn't! \nhttps://stackoverflow.com/questions/20941704/ec2-instance-has-no-public-dns\n\n 1. Go to console.aws.amazon.com\n 2. Go To Services -> VPC\n 3. Open Your VPCs\n 4. select your VPC connected to your EC2 and\n 5. select Actions => Edit DNS Hostnames ---> Change DNS hostnames: to YES\n\nAaand it worked!\n\nHow did it get like this? I deleted and re-made the VPC numerous times, so it\nwas off by default for some reason. When did I mess with this? Why did I mess\nwith this? Why did it work at all instead of blocking me from the beginning? Who\nknows!\n\nP.S. Digging the \"code journal\" style of tech talk, among other reasons because\nI know I'm not going to accidentally plagiarize some tutorial I've read.\n\nUPDATE:\nJust tried to log back in with my settings from before, and wouldnchaknowit, it\nsuddenly started being wacky again! Exact same problems too - can log in for a\nbit shortly after the instance starts, then connection reset, then temporarily\nunavailable.\n\nI decided to look at the System Logs (accessible from Actions -> Instance\nSettings -> Get System Log). I noticed that it was blank. And when logs showed\nup, coincidentally my connection was reset again! The last line of the system\nlog was ip-172-30-0-53 login:. A clue, mayhaps! Maybe it has something to do\nwith the little intranet it was logged into!\n\nFrantic googling. Eventually, I discover that when I created my account, there\nwas a system called \"EC2 Classic\" in place (it presumably was not called this at\nthe time). They eventually added the VPC feature (short and sweet: VPC stands\nfor either \"Volatile Psionic Cloak\" or \"Virtual Private Cloud\", and is one of\nthe several terms that mean \"a place where your VMs run\" (each one has its own\nsubtle idiosyncracies. I will be bitching about them again, I promise you.) Why\ndoesn't this text editor do paren-highlighting? (print-str \"I love lisp\")  Eh,\nlet's say this is enough.)\n\nSooo, VPCs put a spanner in the works of how EC2 classic worked. If you made\nyour AWS account after VPC was introduced, you had to do stuff with VPC.\nHowever, if your account was old enough that you had access to EC2 Classic, they\nlet you use both systems so as not to nuke old infrastructure you might have\nhad. Note that whether you were \"VPC Only\" or \"VPC And EC2 Classic\" is something\nthat's flagged at the account level.\n\nI think it MIGHT have been okay, but while trying to log in, I deleted the VPC\nthat was present cuz I read that it'd spawn a new one that was set to default\noptions. Now, this did happen, except that the one I deleted was my \"Default\nVPC\". I do not fully understand the signifigance of this, but it seems to be\nwhat was getting in my way. So, simple - just make a new Default VPC! However,\nif you have an \"EC2 And VPC\" account, you cannot make a new Default VPC (for\nreasons that are mysterious to me).\n\nRemember when I said \"VPC and EC2 Classic\" status was at the account level?\nUnfortunately, that means you need to contact AWS support in order to change it.\nIf you've ever used normal Amazon customer support, you're probably accustomed\nto it being pretty good - you just open a chat window, say your stuff didn't\narrive, then they overnight the missing delivery. AWS support (if you're not\npaying extra money) is not like that. I put in the request on Wednesday night,\nand I've had several rounds of confirming \"Yes, I want you to do this\", each\nwith at least a day-long turn-around. It is now Sunday, and I got a message from\nyesterday saying that my account is finally in the process of being moved over.\nHopefully it all goes off without a hitch, but we'll see!","html":"<p>Sometimes I find myself responsible for setting up and maintaining my own infrastructure for doing data stuff.  In light of this, I've taken it upon myself to learn more about AWS in order for this experience to be less terrifying.  I've been following a course on Udemy for the AWS Solutions Architect Certification.  So far, so good.</p>\n<p>Cut to the EC2 section.  Has you spin up a little EC2 instance and SSH into it.  I would find myself SSHing in, then after a few minutes my connection would be reset and then any further attempts would be met with a <code>Resource temporarily unavailable</code>.</p>\n<p>I googled around.  Lots of stuff that didn't work.  I logged into a client's console that I had access to, tried to see if there were any settings that were different from mine.  What on Earth did I mess with?  I first made an AWS account in 2012, and go into phases of messing with my personal account and forgetting it exists.  I must have hit some kind of &quot;Make it so every server you launch is unreachable and useless&quot; button at some point, then forgotten where this button was.</p>\n<p>It's a tough little jungle.  There's numerous different versions of security on AWS.  Then, finally, I noticed an angel on StackOverflow posted that you should check to see whether you have a public DNS address.  Turns out I didn't!  <a href=\"https://stackoverflow.com/questions/20941704/ec2-instance-has-no-public-dns\">https://stackoverflow.com/questions/20941704/ec2-instance-has-no-public-dns</a></p>\n<ol>\n<li>Go to console.aws.amazon.com</li>\n<li>Go To Services -&gt; VPC</li>\n<li>Open Your VPCs</li>\n<li>select your VPC connected to your EC2 and</li>\n<li>select Actions =&gt; Edit DNS Hostnames ---&gt; Change DNS hostnames: to YES</li>\n</ol>\n<p>Aaand it worked!</p>\n<p>How did it get like this?  I deleted and re-made the VPC numerous times, so it was off by default for some reason.  When did I mess with this?  Why did I mess with this?  Why did it work at all instead of blocking me from the beginning?  Who knows!</p>\n<p>P.S. Digging the &quot;code journal&quot; style of tech talk, among other reasons because I know I'm not going to accidentally plagiarize some tutorial I've read.</p>\n<p>UPDATE:<br>\nJust tried to log back in with my settings from before, and wouldnchaknowit, it suddenly started being wacky again!  Exact same problems too - can log in for a bit shortly after the instance starts, then connection reset, then temporarily unavailable.</p>\n<p>I decided to look at the System Logs (accessible from Actions -&gt; Instance Settings -&gt; Get System Log).  I noticed that it was blank.  And when logs showed up, coincidentally my connection was reset again!  The last line of the system log was <code>ip-172-30-0-53 login:</code>.  A clue, mayhaps!  Maybe it has something to do with the little intranet it was logged into!</p>\n<p>Frantic googling.  Eventually, I discover that when I created my account, there was a system called &quot;EC2 Classic&quot; in place (it presumably was not called this at the time).  They eventually added the VPC feature (short and sweet: VPC stands for either &quot;Volatile Psionic Cloak&quot; or &quot;Virtual Private Cloud&quot;, and is one of the several terms that mean &quot;a place where your VMs run&quot; (each one has its own subtle idiosyncracies.  I will be bitching about them again, I promise you.)  Why doesn't this text editor do paren-highlighting?  <code>(print-str &quot;I love lisp&quot;)</code> Eh, let's say this is enough.)</p>\n<p>Sooo, VPCs put a spanner in the works of how EC2 classic worked.  If you made your AWS account after VPC was introduced, you had to do stuff with VPC.  However, if your account was old enough that you had access to EC2 Classic, they let you use both systems so as not to nuke old infrastructure you might have had.  Note that whether you were &quot;VPC Only&quot; or &quot;VPC And EC2 Classic&quot; is something that's flagged at the account level.</p>\n<p>I think it MIGHT have been okay, but while trying to log in, I deleted the VPC that was present cuz I read that it'd spawn a new one that was set to default options.  Now, this did happen, except that the one I deleted was my &quot;Default VPC&quot;.  I do not fully understand the signifigance of this, but it seems to be what was getting in my way.  So, simple - just make a new Default VPC!  However, if you have an &quot;EC2 And VPC&quot; account, you cannot make a new Default VPC (for reasons that are mysterious to me).</p>\n<p>Remember when I said &quot;VPC and EC2 Classic&quot; status was at the account level?  Unfortunately, that means you need to contact AWS support in order to change it.  If you've ever used normal Amazon customer support, you're probably accustomed to it being pretty good - you just open a chat window, say your stuff didn't arrive, then they overnight the missing delivery.  AWS support (if you're not paying extra money) is not like that.  I put in the request on Wednesday night, and I've had several rounds of confirming &quot;Yes, I want you to do this&quot;, each with at least a day-long turn-around.  It is now Sunday, and I got a message from yesterday saying that my account is finally in the process of being moved over.  Hopefully it all goes off without a hitch, but we'll see!</p>\n","url":"https://hackersandslackers.com/aws-adventures-why-cant-i-ssh-into-my-damn-ec2-instance/","uuid":"62262c95-6926-4f0c-96c7-cb4269f40a43","page":false,"codeinjection_foot":"","codeinjection_head":"","comment_id":"5b186de91e7fe93906b2e8f7"}},"pageContext":{"slug":"aws-adventures-why-cant-i-ssh-into-my-damn-ec2-instance"}}